
<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <title>Static Modal Template</title>
    <style type="text/css">
      * {
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;  
                box-sizing: border-box;
      }
      body {
        padding: 50px;
        background-color: #cbcbcb;
        font-family: Helvetica, Arial, sans-serif;
        font-size: 16px;
        line-height: 26px; /* 26 / 16 ~= Golden Ratio. */
      }

      a {
        font-weight: bold;
      }

      /* Used to apply a blur to background content to give the foreground modal
         window greater contrast and focus. There are performance issues if content 
         needs to be scrolled overtop of this blurred content. Therefor this class 
         is applied only when using a static (non-scrollable) modal window. */
      .blur {
        -webkit-filter: blur(2px);
           -moz-filter: blur(2px);
            -ms-filter: blur(2px);
             -o-filter: blur(2px);
                filter: blur(2px);
      }

      #main {
        z-index: 1;
      }

      /* Using IDs instead of classes for modal-container and modal-panel
         as there should (at least with this implementation) only ever be
         one of each. */
      #modal-container {
        z-index: 9000;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: transparent;
        background-color: rgba(0, 0, 0, .6);
      }
      #modal-container:hover {
        cursor: -webkit-zoom-out;
        cursor:    -moz-zoom-out;
        cursor:         zoom-out;
      }

      #modal-panel {
        z-index: 9002;
        cursor: default;
        position: relative;
        background-color: white;
        width: 500px;
        margin-left: auto;
        margin-right: auto;
        padding: 40px;
        overflow: hidden;
        -webkit-border-radius: 4px;
           -moz-border-radius: 4px;
            -ms-border-radius: 4px;
             -o-border-radius: 4px;
                border-radius: 4px;
        -webkit-box-shadow: 0 10px 80px 0 rgba(0, 0, 0, 1);
           -moz-box-shadow: 0 10px 80px 0 rgba(0, 0, 0, 1);
            -ms-box-shadow: 0 10px 80px 0 rgba(0, 0, 0, 1);
             -o-box-shadow: 0 10px 80px 0 rgba(0, 0, 0, 1);
                box-shadow: 0 10px 80px 0 rgba(0, 0, 0, 1);
      }
      #modal-panel h1 {
        margin: 0 0 20px 0;
      }
      #modal-panel .modal-content {

      }
      #modal-panel .modal-meta {
        font-size: 12px;
        margin-top: 20px;
        margin-bottom: 20px;
      }
      #modal-panel a.modal-close {
      }  
    </style>
  </head>
  <body>
    <div id="main">
      <p><a href="#" class="modal-link" id="modal-12345">Click to Open</a></p>
      <!-- The id of the above link corresponds to an id for JSON data. The idea being that 
           the links could be generated by your backend and match the corresponding data found
           in the JSON object by this id. Only the last part after the hyphen is used. -->
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras a nisi lorem, sed vestibulum 
        justo. Phasellus sagittis eros id ante sodales ut semper enim placerat. Aliquam eu nisl sed 
        tellus tempus accumsan eu eget odio. Sed a neque tortor. Aenean vel est augue. In ac justo 
        quis eros auctor laoreet vel a dolor. Donec a commodo ante.
      </p>
      <p>
        In congue aliquam justo, ac porta justo tincidunt in. Fusce accumsan aliquam erat, sit amet 
        imperdiet diam sodales sed. Pellentesque et felis erat, non accumsan elit. Quisque porttitor 
        feugiat lorem non dictum. Nunc ac nibh non arcu feugiat tempor. Aliquam et dui ac nunc viverra 
        pellentesque. Nam molestie egestas mi, a condimentum nisi adipiscing et. Nunc scelerisque 
        hendrerit laoreet.
      </p>
    </div>

    <script type="text/javascript" src="javascripts/json2.js"></script>
    <script type="text/javascript" src="javascripts/jquery.js"></script>
    <script type="text/javascript" src="javascripts/underscore.js"></script>
    <script type="text/javascript" src="javascripts/mustache.js"></script>

    <script type="text/tempalte" id="modal-template">
      <div id="modal-panel">
        <h1>{{name}}</h1>
        <div class="modal-content">{{content}}</div>
        <div class="modal-meta">Posted on {{date}}.</div>
        <a href="#" class="modal-close">Close</a>
      </div>
    </script>

    <script type="text/javascript">
      // Could potentially put multiple dataItem objects in this array, but for testing purposes
      // we're only using one, searched for by id. This data would ideally come from the server.
      var modalTestData = [
        {
          id: 12345,
          name: 'Static Modal Window',
          content: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque at risus est. Proin nec semper felis. Nulla nec elementum ante. Vivamus tempus venenatis malesuada. Maecenas orci risus, aliquam pellentesque iaculis eget, semper vitae tortor. Aliquam dapibus congue magna nec venenatis. Maecenas risus risus, hendrerit a congue non, sagittis non massa.',
          date: 'July 2, 2012 @ 4:15pm'
        }
      ];

      $(function() {
        // Any element with class 'modal-link' will have it's ID attribute analyzed and the last part
        // of that attribute, after the final hyphen, will be used as an id to search the modalTestData
        // array for a matching data object in order to generate a modal window with that content.
        $('.modal-link').click(function(e) {
          // Prevent link action.
          e.preventDefault();

          // Render template.
          var id = parseInt($(this).attr('id').split('-').pop()); // Get the last element of the id string after the last hyphen, which should conventionally be a numerical id.
          var data = _.find(modalTestData, function(dataItem) { return dataItem.id === id; });
          var template = $('#modal-template').html();
          var modalContainer = $('<div/>', { id: 'modal-container' }).appendTo('body');
          modalContainer.html(Mustache.to_html(template, data));

          // Blur main content area.
          $('#main').addClass('blur');

          // Center modal window within viewport.
          var top = $(window).height() / 2 - $('#modal-panel').outerHeight() / 2; // Using outerHeight/Width because of border-box CSS.
          var left = $(window).width() / 2 - $('#modal-panel').outerWidth() / 2;
          $('#modal-panel').offset({ top: top, left: left });

          // Close-event actions.
          $('a.modal-close, #modal-container').click(function(e) {
            e.preventDefault();
            modalContainer.remove(); // Remove modal-container from DOM.
            $('#main').removeClass('blur'); // Unblur main content area.

            return false;
          });
          $('#modal-panel').click(function(e) { // Override a click on the main panel area.
            e.preventDefault();

            return false;
          });

          return false;
        });
      });
    </script>
  </body>
</html>
